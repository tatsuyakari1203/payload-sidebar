// payload-sidebar-plugin
// File Tree Style Sidebar with Lucide Icons and Multi-color Badges
// Note: This file should be imported in the app, not bundled with the plugin

// Mixin replacements (simplified versions)
@mixin mid-break {
  @media (max-width: 1024px) {
    @content;
  }
}

@mixin small-break {
  @media (max-width: 768px) {
    @content;
  }
}

.nav {
    // ========== THEME VARIABLES ==========
    --sidebar-bg: var(--theme-bg);
    --sidebar-text: var(--theme-elevation-700);
    --sidebar-text-hover: var(--theme-elevation-900);
    --sidebar-text-active: var(--theme-elevation-1000);
    --sidebar-accent: var(--theme-elevation-100);
    --sidebar-border: var(--theme-elevation-100);
    --sidebar-icon: var(--theme-elevation-500);
    --sidebar-icon-active: var(--theme-success-500);
    --tree-line: var(--theme-elevation-200);

    // ========== BADGE COLOR VARIABLES ==========
    --badge-red-bg: var(--theme-error-500, #ef4444);
    --badge-red-text: #ffffff;
    --badge-yellow-bg: var(--theme-warning-500, #eab308);
    --badge-yellow-text: #000000;
    --badge-blue-bg: #3b82f6;
    --badge-blue-text: #ffffff;
    --badge-green-bg: var(--theme-success-500, #22c55e);
    --badge-green-text: #ffffff;
    --badge-orange-bg: #f97316;
    --badge-orange-text: #ffffff;
    --badge-gray-bg: var(--theme-elevation-400, #6b7280);
    --badge-gray-text: #ffffff;

    // ========== BASE STYLES ==========
    position: sticky;
    top: 0;
    left: 0;
    flex-shrink: 0;
    height: 100vh;
    width: var(--nav-width);
    background: var(--sidebar-bg);
    border-right: 1px solid var(--sidebar-border);
    opacity: 0;
    overflow: hidden;
    font-size: 13px;
    --nav-padding-inline-start: 16px;
    --nav-padding-inline-end: 16px;
    --nav-padding-block-start: var(--app-header-height);
    --nav-padding-block-end: 16px;

    [dir='rtl'] & {
      border-right: none;
      border-left: 1px solid var(--sidebar-border);
    }

    &--nav-animate {
      transition: opacity 180ms ease;
    }

    &--nav-open {
      opacity: 1;
    }

    // ========== SCROLL CONTAINER ==========
    &__scroll {
      height: 100%;
      display: flex;
      flex-direction: column;
      padding: var(--nav-padding-block-start) var(--nav-padding-inline-end)
        var(--nav-padding-block-end) var(--nav-padding-inline-start);
      overflow-y: auto;
      overflow-x: hidden;

      // Minimal scrollbar
      &::-webkit-scrollbar {
        width: 8px;
      }

      &::-webkit-scrollbar-track {
        background: transparent;
      }

      &::-webkit-scrollbar-thumb {
        background: transparent;
        border-radius: 4px;
      }

      &:hover::-webkit-scrollbar-thumb {
        background: var(--theme-elevation-150);
      }
    }

    &__wrap {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      flex-grow: 1;
    }

    // ========== NAV LINK ==========
    &__link {
      display: flex;
      align-items: center;
      gap: 10px;
      width: calc(100% + 32px) !important;
      margin-left: -16px !important;
      margin-right: -16px !important;
      padding: 7px 28px !important;
      font-size: 13px;
      font-weight: 400;
      line-height: 1.4;
      color: var(--sidebar-text);
      text-decoration: none !important;
      border-radius: 0;
      position: relative;
      transition:
        background-color 100ms ease,
        color 100ms ease;

      &:hover {
        background: var(--sidebar-accent);
        color: var(--sidebar-text-hover);

        .nav__link-icon {
          color: var(--sidebar-text-hover);
        }
      }

      &:focus-visible {
        outline: 2px solid var(--theme-elevation-300);
        outline-offset: -2px;
      }

      // Active state
      &--active {
        background: var(--sidebar-accent);
        color: var(--sidebar-text-active);
        font-weight: 500;

        .nav__link-icon {
          color: var(--sidebar-icon-active);
        }
      }
    }

    // Icon styles
    &__link-icon {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
      color: var(--sidebar-icon);
      transition: color 100ms ease;
    }

    // External link icon (small indicator)
    &__link-external-icon {
      width: 12px;
      height: 12px;
      flex-shrink: 0;
      color: var(--theme-elevation-400);
      margin-left: -4px;
      opacity: 0.7;
    }

    &__link-label {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    // External link styling
    &__link--external {
      .nav__link-label {
        // Slightly different styling for external links
      }

      &:hover .nav__link-external-icon {
        opacity: 1;
        color: var(--sidebar-text-hover);
      }
    }

    // ========== BADGE STYLES ==========
    &__link-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 18px;
      height: 18px;
      padding: 0 5px;
      margin-left: auto;
      margin-right: 24px; // Space for pin button
      font-size: 11px;
      font-weight: 600;
      border-radius: 9px;
      flex-shrink: 0;
      // Crisp rendering
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
      backface-visibility: hidden;
      transform: translateZ(0); // Force GPU layer for crisp rendering

      // Default (red)
      background: var(--badge-red-bg);
      color: var(--badge-red-text);

      // Color variants
      &--red {
        background: var(--badge-red-bg);
        color: var(--badge-red-text);
      }

      &--yellow {
        background: var(--badge-yellow-bg);
        color: var(--badge-yellow-text);
      }

      &--blue {
        background: var(--badge-blue-bg);
        color: var(--badge-blue-text);
      }

      &--green {
        background: var(--badge-green-bg);
        color: var(--badge-green-text);
      }

      &--orange {
        background: var(--badge-orange-bg);
        color: var(--badge-orange-text);
      }

      &--gray {
        background: var(--badge-gray-bg);
        color: var(--badge-gray-text);
      }
    }

    // ========== CONTROLS SECTION ==========
    &__controls {
      margin-top: auto;
      padding-top: 12px;
      border-top: 1px solid var(--sidebar-border);
      display: flex;
      flex-direction: column;
      gap: 2px;

      .btn {
        display: flex;
        align-items: center;
        gap: 8px;
        width: 100%;
        padding: 6px 8px;
        font-size: 13px;
        font-weight: 400;
        color: var(--sidebar-text);
        background: transparent;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition:
          background-color 100ms ease,
          color 100ms ease;

        &:hover {
          background: var(--sidebar-accent);
          color: var(--sidebar-text-hover);
        }

        svg {
          width: 16px;
          height: 16px;
          flex-shrink: 0;
          color: var(--sidebar-icon);
        }
      }
    }

    // ========== RESPONSIVE ==========
    @include mid-break {
      &__scroll {
        --nav-padding-inline-start: 12px;
        --nav-padding-inline-end: 12px;
      }
    }

    @include small-break {
      &__scroll {
        --nav-padding-inline-start: var(--gutter-h);
        --nav-padding-inline-end: var(--gutter-h);
      }

      &__link {
        padding: 8px 12px;
        font-size: 14px;
      }
    }

    // ========== PINNED SECTION ==========
    &__pinned-section {
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--sidebar-border);
    }

    &__pinned-header {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--theme-elevation-500);

      svg {
        width: 12px;
        height: 12px;
        color: var(--theme-elevation-400);
      }
    }

    &__pinned-items {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    &__pinned-item {
      display: flex;
      align-items: center;
      position: relative;

      .nav__link {
        flex: 1;
        padding-right: 36px !important;
      }
    }

    &__unpin-btn {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      padding: 0;
      background: transparent;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: var(--theme-elevation-400);
      opacity: 0;
      transition: all 100ms ease;

      &:hover {
        background: var(--theme-elevation-150);
        color: var(--theme-error-500);
      }
    }

    &__pinned-item:hover &__unpin-btn {
      opacity: 1;
    }

    // ========== PIN BUTTON IN NAV LINK ==========
    &__link-wrapper {
      display: flex;
      align-items: center;
      position: relative;

      .nav__link {
        flex: 1;
        padding-right: 36px !important;
      }
    }

    &__pin-btn {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      padding: 0;
      background: transparent;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: var(--theme-elevation-400);
      opacity: 0;
      transition: all 100ms ease;

      &:hover {
        background: var(--theme-elevation-150);
        color: var(--theme-elevation-800);
      }

      &--pinned {
        color: var(--theme-success-500);

        &:hover {
          color: var(--theme-success-600);
        }
      }
    }

    &__link-wrapper:hover &__pin-btn {
      opacity: 1;
    }

    &__pin-btn--pinned {
      opacity: 0.7;
    }

    &__link-wrapper:hover &__pin-btn--pinned {
      opacity: 1;
    }
  }

  // ========== NAV GROUP - Folder style ==========
  .nav-group {
    display: flex;
    flex-direction: column;
    margin-bottom: 8px;

    // Folder header
    &__toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px !important;
      font-size: 11px !important;
      font-weight: 600 !important;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--theme-elevation-500) !important;
      background: transparent !important;
      border: none !important;
      border-radius: 6px;
      cursor: pointer;
      user-select: none;
      transition:
        background-color 100ms ease,
        color 100ms ease;

      &:hover {
        background: var(--sidebar-accent) !important;
        color: var(--sidebar-text-hover) !important;
      }

      // Folder chevron
      svg {
        width: 12px !important;
        height: 12px !important;
        color: var(--theme-elevation-400);
        transition: transform 150ms ease;
        flex-shrink: 0;
      }
    }

    &__content {
      display: flex;
      flex-direction: column;
      gap: 2px;
      padding-left: 0 !important;
      position: relative;
    }

    // Collapsed folder
    &--collapsed {
      .nav-group__toggle svg {
        transform: rotate(-90deg);
      }
    }
  }

  // ========== COLLAPSIBLE ==========
  .collapsible {
    &__toggle {
      border-radius: 6px !important;
    }
  }
